<h2>Informe de Clientes</h2>

<nz-divider></nz-divider>

<app-stats-clientes [estadisticas]="estadisticas"></app-stats-clientes>

<nz-divider></nz-divider>

<div class="filters">
  <nz-input-group [nzSuffix]="suffixIconSearch">
    <input
      type="text"
      nz-input
      placeholder="Buscar"
      [(ngModel)]="searchValue"
    />
  </nz-input-group>
  <ng-template #suffixIconSearch>
    <span nz-icon nzType="search"></span>
  </ng-template>

  <div class="status-filter">
    <span>Filtrar por reservas</span>
    <nz-select [(ngModel)]="selectedStatus" style="width: 120px">

      <nz-option nzValue="0" nzLabel="0"></nz-option>
      <nz-option nzValue="1-10" nzLabel="1-10"></nz-option>
      <nz-option nzValue="11-20" nzLabel="11-20"></nz-option>
      <nz-option nzValue="21-50" nzLabel="21-50"></nz-option>
      <nz-option nzValue="51-100" nzLabel="51-100"></nz-option>
      <nz-option nzValue="Todos" nzLabel="Todos"></nz-option>
    </nz-select>
  </div>

  <button nz-button nzType="primary" (click)="getInformes()">FILTRAR</button>
</div>

@if(loading) {
  <div class="mt-4 mb-4">
    <nz-spin [nzSize]="'large'"></nz-spin>
  </div>
} @else {
  <div class="table-responsive">
    <nz-table #basicTable [nzData]="listClientes">
      <thead>
        <tr>
          <th nzWidth="50px"></th>
          <th>Nombre</th>
          <th>Email</th>
          <th>Tel√©fono</th>
          <th>Reservas Totales</th>
          <th>Reservas Canceladas</th>
          <th>Reservas Finalizadas</th>
          <th>Reservas Aprobadas</th>
          <th>Reservas Pendientes</th>
          <th>Reservas No Aprobadas</th>
        </tr>
      </thead>
      <tbody>
        @for (data of basicTable.data; track $index) {
        <tr>
          <td style="padding: 8px;"
            [nzExpand]="expandSet.has(data._id)"
            (nzExpandChange)="onExpandChange(data._id, $event)"
          ></td>
          <td>{{ data.nombre }} {{ data.apellido }}</td>
          <td>{{ data.email }}</td>
          <td>{{ data.telefono }}</td>
          <td>{{ data.reservasTotales }}</td>
          <td>{{ data.reservasCanceladas }}</td>
          <td>{{ data.reservasFinalizadas }}</td>
          <td>{{ data.reservasAprobadas }}</td>
          <td>{{ data.reservasPendientes }}</td>
          <td>{{ data.reservasNoAprobadas }}</td>
        </tr>
        }
      </tbody>
    </nz-table>
  </div>
}
